const downloadExcel = () => {
  // Fetch API data
  fetch('https://api.example.com/data')
    .then(response => response.json())
    .then(data => {
      // Create a new workbook
      const workbook = new ExcelJS.Workbook();

      // Add a worksheet to the workbook
      const worksheet = workbook.addWorksheet('Sheet 1');

      // Define the header row and column names
      const headers = ['ID', 'Name', 'Email'];
      
      // Set the header row in the worksheet
      worksheet.addRow(headers);

      // Add data from the API to the worksheet
      data.forEach(item => {
        const row = worksheet.addRow([item.id, item.name, item.email]);
        // Customize the row if needed, e.g., add cell formatting, styles, etc.
      });

      // Auto-fit columns in the worksheet
      worksheet.columns.forEach(column => {
        column.width = Math.max(column.header.length, ...column.values.map(cell => (cell ? cell.toString().length : 0))) + 2;
      });

      // Generate the Excel file buffer
      return workbook.xlsx.writeBuffer();
    })
    .then(buffer => {
      // Create a Blob from the buffer
      const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });

      // Save the file using FileSaver.js
      saveAs(blob, 'api_data.xlsx');
    })
    .catch(error => {
      console.error('Error:', error);
    });
};
